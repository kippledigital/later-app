<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Later — Your calm digital companion</title>

<!-- PWA Meta Tags -->
<meta name="description" content="A calm digital companion designed to help people capture, organize, and revisit the important things in their lives.">
<meta name="theme-color" content="#0891b2">
<meta name="background-color" content="#020617">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Later">
<meta name="format-detection" content="telephone=no">

<!-- Manifest -->
<link rel="manifest" href="/manifest.json">

<!-- Icons -->
<link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180x180.png">
<link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png">
<link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png">
<link rel="apple-touch-icon" sizes="120x120" href="/icons/icon-120x120.png">

<!-- Microsoft Tiles -->
<meta name="msapplication-TileColor" content="#0891b2">
<meta name="msapplication-TileImage" content="/icons/icon-144x144.png">
<meta name="msapplication-config" content="/browserconfig.xml">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="https://unpkg.com/@mozilla/readability/Readability.js"></script>
  <script src="src/js/ai-service.js"></script>
  <script src="src/js/background-summary.js"></script>
  <script src="src/js/data.js"></script>
  <script src="src/js/navigation.js"></script>
  <script src="src/js/capture.js"></script>
  <script src="src/js/items.js"></script>
  <script src="src/js/enhanced-swipe.js"></script>
  <script src="src/js/reader.js"></script>
  <!-- Enhanced suggestion system -->
  <script src="src/js/pattern-tracker.js"></script>
  <script src="src/js/scoring-engine.js"></script>
  <script src="src/js/moment-detector.js"></script>
  <script src="src/js/suggestion-coordinator.js"></script>
  <!-- Enhanced item types -->
  <script src="src/js/card-factory.js"></script>
  <script src="src/js/mock-data-generator.js"></script>
  <script src="src/js/context-detection.js"></script>
  <!-- PWA and Performance -->
  <script src="src/js/performance-optimizer.js"></script>
  <script src="src/js/pwa-manager.js"></script>
  <!-- Gentle Insights -->
  <script src="src/js/insights-tracker.js"></script>
  <script src="src/js/gentle-visualizations.js"></script>
  <script src="src/js/insights-manager.js"></script>
  <!-- Bulk Actions -->
  <script src="src/js/bulk-actions-manager.js"></script>
  <!-- Collections -->
  <script src="src/js/collections-manager.js"></script>
  <script src="src/js/collections-view.js"></script>
  <!-- Knowledge Processing -->
  <script src="src/js/knowledge-processor.js"></script>
  <script src="src/js/knowledge-view.js"></script>
  <script src="src/js/search.js"></script>
  <script src="src/js/app.js"></script>
<style>
@keyframes shimmerX { from { transform: translate3d(-40%,0,0) skewX(-12deg); } to { transform: translate3d(140%,0,0) skewX(-12deg); } }

/* Enhanced swipe animations */
.swipe-item {
  position: relative;
  overflow: hidden;
  transition: all 0.2s ease;
}

.swipe-item.swiping {
  z-index: 10;
}

.swipe-item .card-content {
  will-change: transform, opacity;
  backface-visibility: hidden;
  transform-style: preserve-3d;
}

.swipe-indicators {
  transition: opacity 0.2s ease;
}

/* Success feedback animation */
@keyframes slideInFromTop {
  from {
    transform: translate(-50%, -20px);
    opacity: 0;
  }
  to {
    transform: translate(-50%, 0);
    opacity: 1;
  }
}

@keyframes slideOutToTop {
  from {
    transform: translate(-50%, 0);
    opacity: 1;
  }
  to {
    transform: translate(-50%, -20px);
    opacity: 0;
  }
}

/* Category menu animations */
#categoryMenu {
  animation: slideInFromTop 0.2s ease-out;
}

/* Confirmation dialog animations */
#confirmationDialog {
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Haptic feedback simulation */
@keyframes hapticPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(0.999); }
}

/* Insights button animation */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Multi-select mode styles */
.multi-select-mode [data-id] {
  cursor: pointer;
  transition: all 0.2s ease;
}

.multi-select-mode [data-id]:hover {
  transform: scale(0.98);
  opacity: 0.8;
}

.multi-select-mode [data-id].selected {
  transform: scale(0.95);
  ring: 2px solid rgb(6 182 212 / 0.5);
  background: linear-gradient(135deg, rgba(6, 182, 212, 0.1) 0%, rgba(6, 182, 212, 0.05) 100%);
}

.selection-indicator {
  animation: selectionPop 0.2s ease-out;
}

@keyframes selectionPop {
  0% { transform: scale(0); opacity: 0; }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); opacity: 1; }
}

/* Batch actions animations */
@keyframes slideUpFromBottom {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Collections drag and drop styles */
.collection-card, .collection-item {
  transition: all 0.2s ease;
}

.collection-card:hover, .collection-item:hover {
  transform: translateY(-2px);
}

.drop-highlight {
  ring: 2px solid rgb(168 85 247 / 0.5);
  background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(168, 85, 247, 0.05) 100%);
  transform: scale(1.02);
}

[draggable="true"]:hover {
  cursor: grab;
}

[draggable="true"]:active {
  cursor: grabbing;
}

/* Collection progress animations */
.collection-progress {
  transition: all 0.3s ease;
}

/* View transition animations */
.view-transition {
  animation: viewFadeIn 0.3s ease-out;
}

@keyframes viewFadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Reader overlay styles */
#readerOverlay {
  overflow-y: auto;
  scroll-behavior: smooth;
}

.reader-content {
  min-height: calc(100vh - 8rem);
}

/* Article content styling */
#readerOverlay .prose {
  color: #e2e8f0;
  line-height: 1.7;
}

#readerOverlay .prose h1,
#readerOverlay .prose h2,
#readerOverlay .prose h3,
#readerOverlay .prose h4,
#readerOverlay .prose h5,
#readerOverlay .prose h6 {
  color: #f1f5f9;
  font-weight: 600;
  margin-top: 2rem;
  margin-bottom: 1rem;
}

#readerOverlay .prose h1 {
  font-size: 2rem;
  line-height: 1.2;
}

#readerOverlay .prose h2 {
  font-size: 1.5rem;
  line-height: 1.3;
}

#readerOverlay .prose h3 {
  font-size: 1.25rem;
  line-height: 1.4;
}

#readerOverlay .prose p {
  margin-bottom: 1.5rem;
  color: #cbd5e1;
}

#readerOverlay .prose a {
  color: #67e8f9;
  text-decoration: underline;
  text-decoration-color: rgba(103, 232, 249, 0.3);
  transition: all 0.2s ease;
}

#readerOverlay .prose a:hover {
  color: #22d3ee;
  text-decoration-color: rgba(34, 211, 238, 0.6);
}

#readerOverlay .prose img {
  border-radius: 0.5rem;
  margin: 1.5rem 0;
  max-width: 100%;
  height: auto;
}

#readerOverlay .prose blockquote {
  border-left: 4px solid #67e8f9;
  padding-left: 1rem;
  margin: 1.5rem 0;
  font-style: italic;
  color: #94a3b8;
}

#readerOverlay .prose ul,
#readerOverlay .prose ol {
  margin: 1rem 0;
  padding-left: 1.5rem;
}

#readerOverlay .prose li {
  margin: 0.5rem 0;
  color: #cbd5e1;
}

#readerOverlay .prose code {
  background: rgba(255, 255, 255, 0.1);
  padding: 0.125rem 0.25rem;
  border-radius: 0.25rem;
  font-size: 0.875em;
  color: #fbbf24;
}

#readerOverlay .prose pre {
  background: rgba(0, 0, 0, 0.3);
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  margin: 1.5rem 0;
}

#readerOverlay .prose pre code {
  background: none;
  padding: 0;
  color: #e2e8f0;
}

/* Light theme for reader */
#readerOverlay.light-theme {
  background: #f8fafc;
  color: #1e293b;
}

#readerOverlay.light-theme .reader-header,
#readerOverlay.light-theme .reader-footer {
  background: rgba(248, 250, 252, 0.95);
  border-color: rgba(0, 0, 0, 0.1);
}

#readerOverlay.light-theme .prose {
  color: #334155;
}

#readerOverlay.light-theme .prose h1,
#readerOverlay.light-theme .prose h2,
#readerOverlay.light-theme .prose h3,
#readerOverlay.light-theme .prose h4,
#readerOverlay.light-theme .prose h5,
#readerOverlay.light-theme .prose h6 {
  color: #0f172a;
}

#readerOverlay.light-theme .prose p {
  color: #475569;
}

#readerOverlay.light-theme .prose a {
  color: #0ea5e9;
}

#readerOverlay.light-theme .prose blockquote {
  border-left-color: #0ea5e9;
  color: #64748b;
}

#readerOverlay.light-theme .prose li {
  color: #475569;
}

#readerOverlay.light-theme .prose code {
  background: rgba(0, 0, 0, 0.1);
  color: #dc2626;
}

#readerOverlay.light-theme .prose pre {
  background: rgba(0, 0, 0, 0.05);
}

#readerOverlay.light-theme .prose pre code {
  color: #334155;
}

/* Font size variations */
#readerOverlay .prose.text-sm {
  font-size: 0.875rem;
}

#readerOverlay .prose.text-base {
  font-size: 1rem;
}

#readerOverlay .prose.text-lg {
  font-size: 1.125rem;
}

/* Line clamp utilities */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* PWA-specific styles */
.pwa-installed {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

/* Performance optimizations */
.loaded {
  opacity: 1 !important;
}

.error {
  opacity: 0.5;
  filter: grayscale(100%);
}

/* Virtual scrolling container */
.virtual-scroll-container {
  contain: layout style paint;
  overflow-anchor: none;
}

.virtual-item-wrapper {
  contain: layout style paint size;
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .reduce-motion * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  .reduce-motion .essential-animation {
    animation-duration: revert !important;
    transition-duration: revert !important;
  }
}

/* Touch optimization */
@media (hover: none) and (pointer: coarse) {
  button, .clickable {
    min-height: 44px;
    min-width: 44px;
  }
}

/* High contrast support */
@media (prefers-contrast: high) {
  .bg-white\/5 {
    background-color: rgba(255, 255, 255, 0.15) !important;
  }

  .ring-white\/10 {
    ring-color: rgba(255, 255, 255, 0.3) !important;
  }
}

/* Forced colors mode support */
@media (forced-colors: active) {
  .bg-gradient-to-r {
    background: ButtonFace !important;
  }

  .text-slate-300 {
    color: ButtonText !important;
  }
}

/* Content interaction styles */
.reader-highlight {
  background: rgba(251, 191, 36, 0.3);
  border-radius: 3px;
  padding: 2px 0;
  position: relative;
  cursor: pointer;
  transition: all 0.2s ease;
}

.reader-highlight:hover {
  background: rgba(251, 191, 36, 0.4);
}

.reader-highlight.yellow { background: rgba(251, 191, 36, 0.3); }
.reader-highlight.green { background: rgba(34, 197, 94, 0.3); }
.reader-highlight.blue { background: rgba(59, 130, 246, 0.3); }
.reader-highlight.purple { background: rgba(147, 51, 234, 0.3); }
.reader-highlight.red { background: rgba(239, 68, 68, 0.3); }

.reader-note-indicator {
  position: absolute;
  top: -8px;
  right: -8px;
  width: 16px;
  height: 16px;
  background: rgba(147, 51, 234, 0.9);
  border-radius: 50%;
  display: flex;
  items: center;
  justify-content: center;
  font-size: 10px;
  color: white;
  cursor: pointer;
}

.selection-active #readerOverlay {
  user-select: text;
  -webkit-user-select: text;
  -moz-user-select: text;
}

.content-tools-active .reader-content {
  padding-top: 140px; /* Account for toolbar */
}

/* Smooth transitions for view switching */
#readerContent {
  transition: transform 0.3s ease, opacity 0.2s ease;
}

/* Swipe indicator styles */
#swipeIndicator {
  transition: opacity 0.2s ease, transform 0.2s ease;
}

/* Article image loading states */
.card-item img.loaded {
  opacity: 1;
  transition: opacity 0.3s ease;
}

.card-item img:not(.loaded) {
  opacity: 0.7;
}

.card-item .image-fallback {
  display: none;
}

.card-item img[style*="display: none"] + .image-fallback {
  display: flex !important;
}
</style>
</head>
<body class="antialiased bg-slate-950 text-slate-200 selection:bg-cyan-400/30">
  <!-- App Shell -->
  <div class="min-h-[100dvh] w-full flex flex-col items-center">
    <!-- Safe area container -->
    <div class="w-full max-w-[460px] flex-1 flex flex-col">
      <!-- Top System Bar -->
      <div class="h-6"></div>

      <!-- App Header -->
      <header class="relative px-4 pt-2 pb-3 sticky top-0 z-40 bg-slate-950/80 backdrop-blur supports-[backdrop-filter]:bg-slate-950/70 border-b border-white/5">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="flex h-8 w-8 items-center justify-center rounded-md bg-cyan-400/15 ring-1 ring-cyan-400/25">
              <span class="text-cyan-300 text-[13px] tracking-tight font-semibold" style="letter-spacing:-0.02em;">L</span>
            </div>
            <span class="text-sm text-slate-400">Later</span>
          </div>
          <div class="flex items-center gap-2">
            <!-- Loading sync pill -->
            <div id="syncPill" class="hidden items-center gap-1.5 text-[12px] px-2 py-1 rounded-full bg-cyan-500/10 text-cyan-300 ring-1 ring-cyan-500/20">
              <i data-lucide="refresh-cw" class="w-3.5 h-3.5"></i>
              <span id="syncPillText">Loading…</span>
            </div>
            <button id="addDemoBtn" class="inline-flex items-center gap-2 text-[13px] px-2.5 py-1.5 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors" title="Quick add demo item">
              <i data-lucide="sparkles" class="w-4 h-4 text-cyan-300"></i>
              <span class="text-slate-300">Add</span>
            </button>
            <button id="addEnhancedDemoBtn" class="inline-flex items-center gap-2 text-[13px] px-2.5 py-1.5 rounded-md bg-emerald-500/15 hover:bg-emerald-500/25 ring-1 ring-emerald-500/25 transition-colors" title="Add demo emails, events & tasks">
              <i data-lucide="zap" class="w-4 h-4 text-emerald-300"></i>
              <span class="text-emerald-300">Demo+</span>
            </button>
            <button id="openSearchBtn" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors" title="Search">
              <i data-lucide="search" class="w-4 h-4 text-slate-300"></i>
            </button>
          </div>
        </div>
        <!-- Navigation progress bar -->
        <div id="navProgress" class="pointer-events-none absolute inset-x-0 -bottom-px h-[2px] bg-cyan-400/80 opacity-0 origin-left scale-x-0 transform-gpu rounded-full" style="will-change: transform, opacity; transition: transform 900ms cubic-bezier(0.22,1,0.36,1), opacity 200ms ease;"></div>
        <!-- Offline / network banner -->
        <div id="netBanner" class="hidden mt-2 rounded-lg ring-1 ring-cyan-500/20 bg-cyan-500/10 px-3 py-2">
          <div class="flex items-center justify-between gap-3">
            <div class="flex items-center gap-2 text-cyan-300 text-[13px]">
              <i data-lucide="wifi-off" class="w-4 h-4"></i>
              <span>You're offline. Your space will sync when reconnected.</span>
            </div>
            <div class="flex items-center gap-2">
              <button id="retryNet" class="inline-flex items-center gap-1.5 text-[12px] px-2.5 py-1.5 rounded-md bg-white/5 hover:bg-white/10 text-cyan-300 ring-1 ring-white/10">
                <i data-lucide="refresh-cw" class="w-3.5 h-3.5"></i> Retry
              </button>
              <button id="dismissNet" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10">
                <i data-lucide="x" class="w-4 h-4 text-slate-300"></i>
              </button>
            </div>
          </div>
        </div>
      </header>

      <!-- Screens -->
      <main id="screens" class="flex-1 relative overflow-hidden">
        <!-- Global shimmer overlay -->
        <div id="shimmerOverlay" class="pointer-events-none absolute inset-0 z-10 hidden overflow-hidden" aria-hidden="true">
          <div class="absolute inset-0 bg-slate-950/40"></div>
          <div class="absolute inset-y-0 left-0 h-full w-1/3 max-w-[280px] min-w-[160px] opacity-70" style="background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.08) 50%, rgba(255,255,255,0) 100%); filter: blur(2px); will-change: transform; animation: shimmerX 1.1s linear infinite;"></div>
        </div>

        <!-- NOW / HOME -->
        <section id="screen-now" class="absolute inset-0 overflow-y-auto will-change-transform opacity-100 translate-y-0 transition-all duration-300">
          <div class="px-4 pt-5 pb-28">
            <!-- Greeting with Insights Button -->
            <div class="mb-5">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <p id="greeting" class="text-[28px] md:text-[32px] leading-tight tracking-tight font-semibold text-slate-100"></p>
                  <p id="contextSub" class="text-sm text-slate-400 mt-1"></p>
                </div>
                <div class="ml-4 flex items-center gap-2">
                  <button id="quickCaptureBtn" class="p-2 rounded-lg bg-cyan-500/15 hover:bg-cyan-500/25 ring-1 ring-cyan-500/25 transition-all duration-300 group opacity-0 translate-y-1 animation-delay-300" style="animation: fadeInUp 0.6s ease-out 0.3s forwards;">
                    <i data-lucide="plus" class="w-4 h-4 text-cyan-300 group-hover:text-cyan-200 transition-colors"></i>
                  </button>
                  <button id="insightsBtn" class="p-2 rounded-lg bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-all duration-300 group opacity-0 translate-y-1 animation-delay-500" style="animation: fadeInUp 0.6s ease-out 0.5s forwards;">
                    <i data-lucide="brain" class="w-4 h-4 text-slate-400 group-hover:text-cyan-300 transition-colors"></i>
                  </button>
                </div>
              </div>
            </div>

            <!-- Empty State: Context-specific Now -->
            <div id="emptyNow" class="hidden mb-6">
              <div class="rounded-xl bg-white/5 ring-1 ring-white/10 p-4">
                <div class="flex items-start gap-3">
                  <div class="w-12 h-12 rounded-lg bg-slate-900 ring-1 ring-white/10 flex items-center justify-center shrink-0">
                    <i id="emptyNowIcon" data-lucide="sunrise" class="w-5 h-5 text-cyan-300"></i>
                  </div>
                  <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1.5">
                      <span id="emptyNowKicker" class="text-[11px] px-1.5 py-0.5 rounded bg-cyan-400/10 text-cyan-300 ring-1 ring-cyan-400/20">Morning focus</span>
                      <span class="text-[11px] text-slate-400">No items for this context</span>
                    </div>
                    <h3 id="emptyNowTitle" class="text-[15px] font-medium tracking-tight text-slate-100">Your space is ready for a clear start</h3>
                    <p id="emptyNowBody" class="text-[13px] text-slate-400 mt-0.5">Set one gentle intention or save something inspiring for later.</p>
                    <div class="mt-3 flex items-center gap-2">
                      <button id="emptyNowPrimary" class="inline-flex items-center gap-1.5 text-[13px] px-2.5 py-1.5 rounded-md bg-cyan-500/15 hover:bg-cyan-500/25 text-cyan-300 ring-1 ring-cyan-500/25">
                        <i data-lucide="target" class="w-4 h-4"></i>
                        Plan one focus
                      </button>
                      <button id="emptyNowSecondary" class="inline-flex items-center gap-1.5 text-[13px] px-2.5 py-1.5 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10">
                        <i data-lucide="inbox" class="w-4 h-4"></i>
                        Review Inbox
                      </button>
                    </div>
                  </div>
                  <img id="emptyNowImg" src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=240&auto=format&fit=crop" alt="" class="hidden sm:block w-16 h-16 rounded-lg object-cover ring-1 ring-white/10 shrink-0">
                </div>
              </div>
            </div>

            <!-- Section: Might Need Attention -->
            <div id="section-attention" class="mb-7">
              <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                  <i data-lucide="circle-alert" class="w-4 h-4 text-cyan-300"></i>
                  <h2 class="text-[18px] tracking-tight font-semibold text-slate-100">Might Need Attention</h2>
                </div>
                <button data-nav="inbox" class="text-[13px] text-cyan-300 hover:text-cyan-200 hover:underline">See All</button>
              </div>
              <div class="space-y-3" id="attentionCards">
                <!-- Cards will be dynamically rendered here -->
              </div>
            </div>

            <!-- Section: Continue Reading -->
            <div id="section-reading" class="mb-7">
              <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                  <i data-lucide="book-open" class="w-4 h-4 text-cyan-300"></i>
                  <h2 class="text-[18px] tracking-tight font-semibold text-slate-100">Continue Reading</h2>
                </div>
                <button data-nav="library" class="text-[13px] text-cyan-300 hover:text-cyan-200 hover:underline">See All</button>
              </div>
              <div class="space-y-3" id="readingCards">
                <!-- Cards will be dynamically rendered here -->
              <div id="emptyReading" class="hidden mt-3">
                <div class="rounded-xl bg-white/5 ring-1 ring-white/10 p-4">
                  <div class="flex items-center gap-2 mb-1.5">
                    <i data-lucide="book" class="w-4 h-4 text-cyan-300"></i>
                    <span class="text-sm font-medium text-slate-200">No articles queued — enjoy some quiet.</span>
                  </div>
                  <p class="text-sm text-slate-400">Save something you'd like to revisit and it'll appear here.</p>
                </div>
              </div>
            </div>

            <!-- Section: Explore Your Saves -->
            <div id="section-explore" class="mb-8">
              <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                  <i data-lucide="compass" class="w-4 h-4 text-cyan-300"></i>
                  <h2 class="text-[18px] tracking-tight font-semibold text-slate-100">Explore Your Saves</h2>
                </div>
                <button data-nav="library" class="text-[13px] text-cyan-300 hover:text-cyan-200 hover:underline">See All</button>
              </div>
              <div class="grid grid-cols-1 gap-3" id="exploreCards">
                <!-- Cards will be dynamically rendered here -->
              </div>
              <!-- Empty state: Explore -->
              <div id="emptyExplore" class="hidden mt-3">
                <div class="rounded-xl bg-white/5 ring-1 ring-white/10 p-4">
                  <div class="flex items-center gap-2 mb-1.5">
                    <i data-lucide="compass" class="w-4 h-4 text-cyan-300"></i>
                    <span class="text-sm font-medium text-slate-200">No saved ideas yet — inspiration awaits.</span>
                  </div>
                  <p class="text-sm text-slate-400">Save links, notes, or images to start your creative library.</p>
                </div>
              </div>
            </div>

            <!-- Gentle divider -->
            <div class="h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"></div>
          </div>
        </section>

        <!-- INBOX -->
        <section id="screen-inbox" class="absolute inset-0 overflow-y-auto hidden will-change-transform opacity-0 translate-y-1 transition-all duration-300">
          <div class="px-4 pt-5 pb-28">
            <div class="flex items-center justify-between mb-3">
              <h1 class="text-[20px] tracking-tight font-semibold text-slate-100">Inbox</h1>
              <div class="flex items-center gap-2">
                <button id="smartSelectBtn" class="inline-flex items-center gap-1.5 text-[12px] px-2.5 py-1.5 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10 transition-colors">
                  <i data-lucide="check-square" class="w-3.5 h-3.5"></i>
                  Select
                </button>
                <div id="aiPill" class="hidden items-center gap-1.5 text-[12px] px-2 py-1 rounded-full bg-cyan-500/10 text-cyan-300 ring-1 ring-cyan-500/20 animate-pulse">
                  <i data-lucide="sparkles" class="w-3.5 h-3.5"></i>
                  <span>Organizing…</span>
                </div>
              </div>
            </div>

            <!-- Smart Select Options (hidden by default) -->
            <div id="smartSelectOptions" class="hidden mb-4 p-3 rounded-xl bg-white/5 ring-1 ring-white/10">
              <div class="flex items-center gap-2 mb-3">
                <i data-lucide="zap" class="w-4 h-4 text-cyan-300"></i>
                <span class="text-[14px] font-medium text-slate-200">Smart Select</span>
              </div>
              <div class="grid grid-cols-2 gap-2">
                <button data-smart-select="work-items" class="inline-flex items-center gap-2 text-[13px] px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10 transition-colors">
                  <i data-lucide="briefcase" class="w-3.5 h-3.5"></i>
                  Work items
                </button>
                <button data-smart-select="today-items" class="inline-flex items-center gap-2 text-[13px] px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10 transition-colors">
                  <i data-lucide="calendar" class="w-3.5 h-3.5"></i>
                  From today
                </button>
                <button data-smart-select="quick-tasks" class="inline-flex items-center gap-2 text-[13px] px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10 transition-colors">
                  <i data-lucide="zap" class="w-3.5 h-3.5"></i>
                  Quick tasks
                </button>
                <button data-smart-select="old-items" class="inline-flex items-center gap-2 text-[13px] px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10 transition-colors">
                  <i data-lucide="clock" class="w-3.5 h-3.5"></i>
                  Older items
                </button>
              </div>
            </div>

            <!-- Queue List -->
            <div id="inboxList" class="space-y-2 pt-2">
              <!-- Swipe item 1 -->
              <div class="swipe-item group relative rounded-xl overflow-hidden" data-id="1">
                <div class="absolute inset-0 flex items-center justify-between px-4 pointer-events-none">
                  <div class="flex items-center gap-2 opacity-0 group-[.swiping-right]:opacity-100 transition-opacity">
                    <i data-lucide="tag" class="w-4 h-4 text-emerald-300"></i>
                    <span class="text-[12px] text-emerald-300">Categorize</span>
                  </div>
                  <div class="flex items-center gap-2 opacity-0 group-[.swiping-left]:opacity-100 transition-opacity">
                    <span class="text-[12px] text-rose-300">Archive</span>
                    <i data-lucide="trash-2" class="w-4 h-4 text-rose-300"></i>
                  </div>
                </div>
                <div class="card-content relative bg-white/5 ring-1 ring-white/10 p-3 transition-transform duration-300 ease-out cursor-pointer">
                  <div class="flex items-start gap-3">
                    <div class="shrink-0">
                      <div class="w-8 h-8 rounded-md bg-slate-900 ring-1 ring-white/10 flex items-center justify-center">
                        <i data-lucide="mail" class="w-4 h-4 text-slate-300"></i>
                      </div>
                    </div>
                    <div class="flex-1 min-w-0">
                      <div class="flex items-center gap-2 mb-1">
                        <button class="inbox-tag inline-flex items-center gap-1.5 text-[11px] px-1.5 py-0.5 rounded bg-white/5 text-slate-300 ring-1 ring-white/10">
                          <i data-lucide="tag" class="w-3.5 h-3.5"></i> Unsorted
                        </button>
                        <span class="text-[11px] text-slate-400 flex items-center gap-1"><i data-lucide="clock" class="w-3.5 h-3.5"></i>2h ago</span>
                      </div>
                      <h3 class="text-[15px] font-medium tracking-tight text-slate-100 truncate">Follow-up: Field trip forms</h3>
                      <p class="text-[13px] text-slate-400 line-clamp-2">Just checking if you had a chance to sign the consent form. Thank you!</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Swipe item 2 -->
              <div class="swipe-item group relative rounded-xl overflow-hidden" data-id="2">
                <div class="absolute inset-0 flex items-center justify-between px-4 pointer-events-none">
                  <div class="flex items-center gap-2 opacity-0 group-[.swiping-right]:opacity-100 transition-opacity">
                    <i data-lucide="tag" class="w-4 h-4 text-emerald-300"></i>
                    <span class="text-[12px] text-emerald-300">Categorize</span>
                  </div>
                  <div class="flex items-center gap-2 opacity-0 group-[.swiping-left]:opacity-100 transition-opacity">
                    <span class="text-[12px] text-rose-300">Archive</span>
                    <i data-lucide="trash-2" class="w-4 h-4 text-rose-300"></i>
                  </div>
                </div>
                <div class="card-content relative bg-white/5 ring-1 ring-white/10 p-3 transition-transform duration-300 ease-out cursor-pointer">
                  <div class="flex items-start gap-3">
                    <div class="shrink-0">
                      <div class="w-8 h-8 rounded-md bg-slate-900 ring-1 ring-white/10 flex items-center justify-center">
                        <i data-lucide="calendar" class="w-4 h-4 text-slate-300"></i>
                      </div>
                    </div>
                    <div class="flex-1 min-w-0">
                      <div class="flex items-center gap-2 mb-1">
                        <button class="inbox-tag inline-flex items-center gap-1.5 text-[11px] px-1.5 py-0.5 rounded bg-white/5 text-slate-300 ring-1 ring-white/10">
                          <i data-lucide="tag" class="w-3.5 h-3.5"></i> Unsorted
                        </button>
                        <span class="text-[11px] text-slate-400 flex items-center gap-1"><i data-lucide="clock" class="w-3.5 h-3.5"></i>Today</span>
                      </div>
                      <h3 class="text-[15px] font-medium tracking-tight text-slate-100 truncate">Dentist appointment reminder</h3>
                      <p class="text-[13px] text-slate-400 line-clamp-2">Reminder for your routine cleaning on Thursday at 3:30 PM.</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Swipe item 3 -->
              <div class="swipe-item group relative rounded-xl overflow-hidden" data-id="3">
                <div class="absolute inset-0 flex items-center justify-between px-4 pointer-events-none">
                  <div class="flex items-center gap-2 opacity-0 group-[.swiping-right]:opacity-100 transition-opacity">
                    <i data-lucide="tag" class="w-4 h-4 text-emerald-300"></i>
                    <span class="text-[12px] text-emerald-300">Categorize</span>
                  </div>
                  <div class="flex items-center gap-2 opacity-0 group-[.swiping-left]:opacity-100 transition-opacity">
                    <span class="text-[12px] text-rose-300">Archive</span>
                    <i data-lucide="trash-2" class="w-4 h-4 text-rose-300"></i>
                  </div>
                </div>
                <div class="card-content relative bg-white/5 ring-1 ring-white/10 p-3 transition-transform duration-300 ease-out cursor-pointer">
                  <div class="flex items-start gap-3">
                    <div class="shrink-0">
                      <div class="w-8 h-8 rounded-md bg-slate-900 ring-1 ring-white/10 flex items-center justify-center">
                        <i data-lucide="file-text" class="w-4 h-4 text-slate-300"></i>
                      </div>
                    </div>
                    <div class="flex-1 min-w-0">
                      <div class="flex items-center gap-2 mb-1">
                        <button class="inbox-tag inline-flex items-center gap-1.5 text-[11px] px-1.5 py-0.5 rounded bg-white/5 text-slate-300 ring-1 ring-white/10">
                          <i data-lucide="tag" class="w-3.5 h-3.5"></i> Unsorted
                        </button>
                        <span class="text-[11px] text-slate-400 flex items-center gap-1"><i data-lucide="clock" class="w-3.5 h-3.5"></i>Mon</span>
                      </div>
                      <h3 class="text-[15px] font-medium tracking-tight text-slate-100 truncate">Invoice from Riverside Dental</h3>
                      <p class="text-[13px] text-slate-400 line-clamp-2">Your invoice for the last visit is attached. Balance due by the end of the month.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Inbox Empty State (first-time friendly) -->
            <div id="inboxEmpty" class="hidden mt-6">
              <div class="rounded-xl bg-white/5 ring-1 ring-white/10 p-5">
                <div class="flex items-start gap-3">
                  <div class="w-12 h-12 rounded-lg bg-slate-900 ring-1 ring-white/10 flex items-center justify-center">
                    <i data-lucide="inbox" class="w-5 h-5 text-cyan-300"></i>
                  </div>
                  <div class="flex-1">
                    <h3 class="text-[15px] font-medium tracking-tight text-slate-100">Your space is ready</h3>
                    <p class="text-[13px] text-slate-400 mt-0.5">A calm inbox starts empty. Add one thing and let the system hold it for you.</p>
                    <ul class="mt-3 space-y-2">
                      <li class="flex items-start gap-2">
                        <i data-lucide="plus-circle" class="w-4 h-4 text-cyan-300 mt-0.5"></i>
                        <span class="text-[13px] text-slate-300">Capture a quick note, link, or idea.</span>
                      </li>
                      <li class="flex items-start gap-2">
                        <i data-lucide="tag" class="w-4 h-4 text-cyan-300 mt-0.5"></i>
                        <span class="text-[13px] text-slate-300">Optionally tag it as Work, Life, or Inspiration.</span>
                      </li>
                      <li class="flex items-start gap-2">
                        <i data-lucide="wand-2" class="w-4 h-4 text-cyan-300 mt-0.5"></i>
                        <span class="text-[13px] text-slate-300">We'll keep things tidy and stress-free.</span>
                      </li>
                    </ul>
                    <div class="mt-4 flex items-center gap-2">
                      <button id="inboxGetStarted" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-cyan-500/15 hover:bg-cyan-500/25 text-cyan-300 ring-1 ring-cyan-500/25">
                        <i data-lucide="pencil" class="w-4 h-4"></i>
                        Capture something quick
                      </button>
                      <button id="inboxBrowseLibrary" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10">
                        <i data-lucide="library" class="w-4 h-4"></i>
                        Explore Library
                      </button>
                    </div>
                  </div>
                  <img src="https://images.unsplash.com/photo-1545665277-5937489579f2?q=80&w=240&auto=format&fit=crop" alt="" class="hidden sm:block w-20 h-20 rounded-lg object-cover ring-1 ring-white/10">
                </div>
              </div>
            </div>

            <!-- Gentle divider -->
            <div class="mt-6 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"></div>
          </div>
        </section>

        <!-- LIBRARY -->
        <section id="screen-library" class="absolute inset-0 overflow-y-auto hidden will-change-transform opacity-0 translate-y-1 transition-all duration-300">
          <div class="px-4 pt-5 pb-28">
            <div class="flex items-center justify-between mb-3">
              <h1 class="text-[20px] tracking-tight font-semibold text-slate-100">Library</h1>
            </div>

            <!-- Filters -->
            <div class="flex items-center gap-2 mb-4">
              <div id="categoryFilters" class="flex items-center gap-2">
                <button data-cat="all" class="cat-pill inline-flex items-center gap-1.5 text-[12px] px-2.5 py-1.5 rounded-full bg-white/10 text-slate-200 ring-1 ring-white/10">All</button>
                <button data-cat="work" class="cat-pill inline-flex items-center gap-1.5 text-[12px] px-2.5 py-1.5 rounded-full bg-white/5 text-slate-300 ring-1 ring-white/10">Work</button>
                <button data-cat="life" class="cat-pill inline-flex items-center gap-1.5 text-[12px] px-2.5 py-1.5 rounded-full bg-white/5 text-slate-300 ring-1 ring-white/10">Life</button>
                <button data-cat="inspiration" class="cat-pill inline-flex items-center gap-1.5 text-[12px] px-2.5 py-1.5 rounded-full bg-white/5 text-slate-300 ring-1 ring-white/10">Inspiration</button>
              </div>
            </div>

            <!-- Library Grid -->
            <div id="libraryGrid" class="grid grid-cols-1 gap-3">
              <article class="lib-item rounded-xl bg-white/5 ring-1 ring-white/10 p-3" data-cat="work">
                <div class="flex items-start gap-3">
                  <div class="w-10 h-10 rounded-md bg-slate-900 ring-1 ring-white/10 flex items-center justify-center">
                    <i data-lucide="file-text" class="w-4 h-4 text-slate-300"></i>
                  </div>
                  <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1">
                      <span class="text-[11px] px-1.5 py-0.5 rounded bg-cyan-400/10 text-cyan-300 ring-1 ring-cyan-400/20">Work</span>
                      <span class="text-[11px] text-slate-400">Added today</span>
                    </div>
                    <h3 class="text-[15px] font-medium tracking-tight text-slate-100 truncate">Team meeting notes template</h3>
                    <p class="text-[13px] text-slate-400 line-clamp-2">A calm format to capture decisions, owners, and next steps without noise.</p>
                  </div>
                </div>
              </article>

              <article class="lib-item rounded-xl bg-white/5 ring-1 ring-white/10 p-3" data-cat="life">
                <div class="flex items-start gap-3">
                  <img src="https://images.unsplash.com/photo-1621619856624-42fd193a0661?w=1080&q=80" alt="Plants" class="w-14 h-14 rounded-md object-cover ring-1 ring-white/10">
                  <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1">
                      <span class="text-[11px] px-1.5 py-0.5 rounded bg-cyan-400/10 text-cyan-300 ring-1 ring-cyan-400/20">Life</span>
                      <span class="text-[11px] text-slate-400">Added this week</span>
                    </div>
                    <h3 class="text-[15px] font-medium tracking-tight text-slate-100 truncate">Low-maintenance houseplants</h3>
                    <p class="text-[13px] text-slate-400 line-clamp-2">Notes and links on plants that thrive with gentle attention.</p>
                  </div>
                </div>
              </article>

              <article class="lib-item rounded-xl bg-white/5 ring-1 ring-white/10 p-3" data-cat="inspiration">
                <div class="flex items-start gap-3">
                  <img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=400&auto=format&fit=crop" alt="Sunset" class="w-14 h-14 rounded-md object-cover ring-1 ring-white/10">
                  <div class="flex-1 min-w-0">
                    <div class="flex items-center gap-2 mb-1">
                      <span class="text-[11px] px-1.5 py-0.5 rounded bg-cyan-400/10 text-cyan-300 ring-1 ring-cyan-400/20">Inspiration</span>
                      <span class="text-[11px] text-slate-400">Saved earlier</span>
                    </div>
                    <h3 class="text-[15px] font-medium tracking-tight text-slate-100 truncate">Calm color palettes</h3>
                    <p class="text-[13px] text-slate-400 line-clamp-2">Muted gradients and soft contrasts for restful interfaces.</p>
                  </div>
                </div>
              </article>
            </div>

            <!-- Library Filtered Empty -->
            <div id="libraryFilteredEmpty" class="hidden mt-6">
              <div class="rounded-xl bg-white/5 ring-1 ring-white/10 p-5">
                <div class="flex items-start gap-3">
                  <div class="w-12 h-12 rounded-lg bg-slate-900 ring-1 ring-white/10 flex items-center justify-center">
                    <i data-lucide="filter" class="w-5 h-5 text-cyan-300"></i>
                  </div>
                  <div class="flex-1">
                    <h3 class="text-[15px] font-medium tracking-tight text-slate-100"><span id="libFilterTitle">No items in Work</span></h3>
                    <p class="text-[13px] text-slate-400 mt-0.5">Try clearing the filter, or capture something new in this category.</p>
                    <div class="mt-3 flex items-center gap-2">
                      <button id="clearLibFilter" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10">
                        <i data-lucide="x-circle" class="w-4 h-4"></i>
                        Clear filter
                      </button>
                      <button id="captureForFilter" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-cyan-500/15 hover:bg-cyan-500/25 text-cyan-300 ring-1 ring-cyan-500/25">
                        <i data-lucide="pencil" class="w-4 h-4"></i>
                        Capture to <span id="filterCatName">Work</span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Library Empty State (enhanced) -->
            <div id="libraryEmpty" class="hidden mt-6">
              <div class="rounded-xl bg-white/5 ring-1 ring-white/10 p-5">
                <div class="flex items-start gap-3">
                  <div class="w-12 h-12 rounded-lg bg-slate-900 ring-1 ring-white/10 flex items-center justify-center">
                    <i data-lucide="bookmark" class="w-5 h-5 text-cyan-300"></i>
                  </div>
                  <div class="flex-1">
                    <h3 class="text-[15px] font-medium tracking-tight text-slate-100">Your library is waiting</h3>
                    <p class="text-[13px] text-slate-400 mt-0.5">Save your first article, idea, or note — we'll keep it neatly organized.</p>
                    <ul class="mt-3 space-y-2">
                      <li class="flex items-start gap-2">
                        <i data-lucide="book-open" class="w-4 h-4 text-cyan-300 mt-0.5"></i>
                        <span class="text-[13px] text-slate-300">Add a link you want to read later.</span>
                      </li>
                      <li class="flex items-start gap-2">
                        <i data-lucide="image" class="w-4 h-4 text-cyan-300 mt-0.5"></i>
                        <span class="text-[13px] text-slate-300">Save an image or idea for inspiration.</span>
                      </li>
                    </ul>
                    <div class="mt-4 flex items-center gap-2">
                      <button id="libraryGetStarted" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-cyan-500/15 hover:bg-cyan-500/25 text-cyan-300 ring-1 ring-cyan-500/25">
                        <i data-lucide="save" class="w-4 h-4"></i>
                        Save your first item
                      </button>
                      <button id="libraryCaptureIdea" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10">
                        <i data-lucide="pencil" class="w-4 h-4"></i>
                        Capture an idea
                      </button>
                    </div>
                  </div>
                  <img src="https://images.unsplash.com/photo-1487017159836-4e23ece2e4cf?q=80&w=240&auto=format&fit=crop" alt="" class="hidden sm:block w-20 h-20 rounded-lg object-cover ring-1 ring-white/10">
                </div>
              </div>
            </div>

            <!-- Gentle divider -->
            <div class="mt-6 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"></div>
          </div>
        </section>

        <!-- COLLECTIONS -->
        <section id="screen-collections" class="absolute inset-0 overflow-y-auto hidden will-change-transform opacity-0 translate-y-1 transition-all duration-300">
          <!-- Collections content will be rendered by JavaScript -->
        </section>
      </main>

      <!-- Bottom Navigation -->
      <nav class="px-4 pb-[max(1rem,env(safe-area-inset-bottom))] pt-2 sticky bottom-0 bg-slate-950/85 backdrop-blur supports-[backdrop-filter]:bg-slate-950/70 border-t border-white/5 z-40">
        <div class="w-full max-w-[460px] mx-auto grid grid-cols-4 gap-2">
          <button data-nav="now" class="tab-btn inline-flex flex-col items-center gap-1 px-2 py-2 rounded-lg ring-1 ring-white/10 bg-white/5">
            <i data-lucide="home" class="w-4 h-4 text-cyan-300"></i>
            <span class="text-[11px] text-slate-300">Now</span>
          </button>
          <button data-nav="inbox" class="tab-btn inline-flex flex-col items-center gap-1 px-2 py-2 rounded-lg ring-1 ring-white/10 bg-white/0 hover:bg-white/5 transition">
            <i data-lucide="inbox" class="w-4 h-4 text-slate-300"></i>
            <span class="text-[11px] text-slate-300">Inbox</span>
          </button>
          <button data-nav="collections" class="tab-btn inline-flex flex-col items-center gap-1 px-2 py-2 rounded-lg ring-1 ring-white/10 bg-white/0 hover:bg-white/5 transition">
            <i data-lucide="folder" class="w-4 h-4 text-slate-300"></i>
            <span class="text-[11px] text-slate-300">Collections</span>
          </button>
          <button data-nav="library" class="tab-btn inline-flex flex-col items-center gap-1 px-2 py-2 rounded-lg ring-1 ring-white/10 bg-white/0 hover:bg-white/5 transition">
            <i data-lucide="library" class="w-4 h-4 text-slate-300"></i>
            <span class="text-[11px] text-slate-300">Library</span>
          </button>
        </div>
      </nav>
    </div>
  </div>

  <!-- Floating Quick Capture Button -->
  <button id="fabCapture" aria-label="Quick Capture" aria-haspopup="dialog" aria-controls="captureModal" aria-expanded="false" class="fixed right-4 bottom-24 z-50 inline-flex items-center justify-center w-12 h-12 rounded-full bg-cyan-500/20 hover:bg-cyan-500/30 ring-1 ring-cyan-400/30 shadow-lg backdrop-blur">
    <i data-lucide="plus" class="w-5 h-5 text-cyan-300"></i>
  </button>

  <!-- Quick Capture Modal -->
  <div id="captureModal" class="hidden fixed inset-0 z-[85]" role="dialog" aria-modal="true" aria-labelledby="captureTitleLabel">
    <div id="captureBackdrop" class="absolute inset-0 bg-slate-950/60 opacity-0 transition-opacity duration-200"></div>
    <div class="absolute inset-0 flex items-end sm:items-center justify-center p-3 sm:p-4">
      <div id="captureSheet" class="w-full max-w-[520px] sm:rounded-2xl bg-slate-950 ring-1 ring-white/10 shadow-2xl translate-y-6 sm:translate-y-0 sm:scale-[0.98] opacity-0 transition-all duration-200 will-change-transform">
        <div class="flex items-center justify-between px-4 pt-3 pb-2 border-b border-white/5">
          <h2 id="captureTitleLabel" class="text-[18px] tracking-tight font-semibold text-slate-100">Quick Capture</h2>
          <button id="captureClose" class="inline-flex items-center justify-center w-9 h-9 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10">
            <i data-lucide="x" class="w-4 h-4 text-slate-200"></i>
          </button>
        </div>

        <form id="captureForm" class="px-4 pt-3 pb-4">
          <div class="space-y-3">
            <div>
              <label for="capTitle" class="block text-[12px] text-slate-400 mb-1">Title <span class="text-slate-500">(required)</span></label>
              <input id="capTitle" name="title" type="text" required aria-required="true" placeholder="What's this about?" class="w-full text-[14px] px-3 py-2 rounded-md bg-white/5 ring-1 ring-white/10 focus:ring-cyan-400/30 focus:outline-none placeholder:text-slate-500 text-slate-200">
              <p id="capTitleErr" class="mt-1 text-[12px] text-rose-300 hidden">Please enter a title.</p>
            </div>

            <div>
              <label for="capNotes" class="block text-[12px] text-slate-400 mb-1">Notes</label>
              <textarea id="capNotes" name="notes" rows="3" placeholder="Optional details…" class="w-full text-[14px] px-3 py-2 rounded-md bg-white/5 ring-1 ring-white/10 focus:ring-cyan-400/30 focus:outline-none placeholder:text-slate-500 text-slate-200"></textarea>
            </div>

            <div>
              <label for="capUrl" class="block text-[12px] text-slate-400 mb-1">Link</label>
              <input id="capUrl" name="url" type="url" inputmode="url" placeholder="https://…" class="w-full text-[14px] px-3 py-2 rounded-md bg-white/5 ring-1 ring-white/10 focus:ring-cyan-400/30 focus:outline-none placeholder:text-slate-500 text-slate-200">
            </div>

            <div>
              <div class="flex items-center justify-between">
                <label class="text-[12px] text-slate-400">Tag</label>
                <span id="capTagHint" class="text-[11px] text-slate-500">Optional</span>
              </div>
              <div id="capTagGroup" role="radiogroup" aria-label="Tag" class="mt-1 inline-flex p-0.5 rounded-lg bg-white/5 ring-1 ring-white/10">
                <button type="button" role="radio" aria-checked="false" data-tag="work" class="px-3 py-1.5 text-[13px] rounded-md text-slate-300 hover:text-slate-200 inline-flex items-center gap-1.5">
                  <i data-lucide="briefcase" class="w-4 h-4"></i>
                  Work
                </button>
                <button type="button" role="radio" aria-checked="false" data-tag="life" class="px-3 py-1.5 text-[13px] rounded-md text-slate-300 hover:text-slate-200 inline-flex items-center gap-1.5">
                  <i data-lucide="heart" class="w-4 h-4"></i>
                  Life
                </button>
                <button type="button" role="radio" aria-checked="false" data-tag="inspiration" class="px-3 py-1.5 text-[13px] rounded-md text-slate-300 hover:text-slate-200 inline-flex items-center gap-1.5">
                  <i data-lucide="sparkles" class="w-4 h-4"></i>
                  Inspiration
                </button>
              </div>
            </div>
          </div>

          <div class="mt-4 flex items-center justify-end gap-2 border-t border-white/5 pt-3">
            <button type="button" id="capCancel" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 text-slate-300">
              <i data-lucide="x" class="w-4 h-4"></i>
              Cancel
            </button>
            <button type="submit" id="capSave" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-cyan-500/15 hover:bg-cyan-500/25 text-cyan-300 ring-1 ring-cyan-500/25">
              <i data-lucide="save" class="w-4 h-4"></i>
              Save
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Category menu (appears when tapping "Unsorted") -->
  <div id="catMenu" class="hidden fixed z-[90] min-w-[180px] rounded-lg bg-slate-900/95 backdrop-blur ring-1 ring-white/10 p-1 shadow-2xl">
    <div class="px-2 py-1">
      <p class="text-[11px] text-slate-400">Move to</p>
    </div>
    <button data-cat-option="work" class="w-full flex items-center gap-2 px-2.5 py-2 rounded-md hover:bg-white/5 text-[13px] text-slate-200">
      <span class="inline-flex w-6 h-6 items-center justify-center rounded bg-cyan-400/10 ring-1 ring-cyan-400/20">
        <i data-lucide="briefcase" class="w-3.5 h-3.5 text-cyan-300"></i>
      </span>
      Work
    </button>
    <button data-cat-option="life" class="w-full flex items-center gap-2 px-2.5 py-2 rounded-md hover:bg-white/5 text-[13px] text-slate-200">
      <span class="inline-flex w-6 h-6 items-center justify-center rounded bg-emerald-400/10 ring-1 ring-emerald-400/20">
        <i data-lucide="heart" class="w-3.5 h-3.5 text-emerald-300"></i>
      </span>
      Life
    </button>
    <button data-cat-option="inspiration" class="w-full flex items-center gap-2 px-2.5 py-2 rounded-md hover:bg-white/5 text-[13px] text-slate-200">
      <span class="inline-flex w-6 h-6 items-center justify-center rounded bg-purple-400/10 ring-1 ring-purple-400/20">
        <i data-lucide="sparkles" class="w-3.5 h-3.5 text-purple-300"></i>
      </span>
      Inspiration
    </button>
  </div>

  <!-- Confirmation dialog -->
  <div id="confirmDialog" class="hidden fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur">
    <div class="bg-slate-900 rounded-xl ring-1 ring-white/10 p-6 max-w-sm mx-4">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 rounded-lg bg-orange-400/10 ring-1 ring-orange-400/20 flex items-center justify-center">
          <i data-lucide="archive" class="w-5 h-5 text-orange-300"></i>
        </div>
        <div>
          <h3 class="text-[15px] font-medium text-slate-100">Archive Item</h3>
          <p class="text-[13px] text-slate-400">This will move the item to your archive</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <button id="confirmCancel" class="flex-1 inline-flex items-center justify-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10">
          <i data-lucide="x" class="w-4 h-4"></i>
          Cancel
        </button>
        <button id="confirmArchive" class="flex-1 inline-flex items-center justify-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-orange-500/15 hover:bg-orange-500/25 text-orange-300 ring-1 ring-orange-500/25">
          <i data-lucide="archive" class="w-4 h-4"></i>
          Archive
        </button>
      </div>
    </div>
  </div>

  <!-- Reader Overlay -->
  <div id="readerOverlay" class="hidden fixed inset-0 z-[100] bg-slate-950">
    <!-- Reader Header -->
    <div class="reader-header fixed top-0 left-0 right-0 z-10 bg-slate-950/95 backdrop-blur border-b border-white/10">
      <div class="flex items-center gap-3 px-4 py-3">
        <button id="readerBack" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors">
          <i data-lucide="arrow-left" class="w-4 h-4 text-slate-300"></i>
        </button>
        <div class="flex-1 min-w-0">
          <h1 id="readerTitle" class="text-[15px] font-medium text-slate-100 truncate">Loading...</h1>
          <p id="readerUrl" class="text-[12px] text-slate-400 truncate"></p>
        </div>
        <div class="flex items-center gap-2">
          <!-- Summary/Full Toggle -->
          <div id="summaryToggle" class="hidden items-center gap-1 text-[12px] px-2 py-1 rounded-full bg-cyan-500/10 text-cyan-300 ring-1 ring-cyan-500/20">
            <button id="toggleSummary" class="inline-flex items-center gap-1">
              <i data-lucide="zap" class="w-3.5 h-3.5"></i>
              <span id="toggleText">Summary</span>
            </button>
          </div>
          <button id="readerTheme" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors">
            <i data-lucide="sun" class="w-4 h-4 text-slate-300"></i>
          </button>
          <button id="readerFontSize" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors">
            <i data-lucide="type" class="w-4 h-4 text-slate-300"></i>
          </button>
          <button id="readerBookmark" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors">
            <i data-lucide="bookmark" class="w-4 h-4 text-slate-300"></i>
          </button>
          <button id="readerShare" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors">
            <i data-lucide="share" class="w-4 h-4 text-slate-300"></i>
          </button>
          <button id="readerClose" class="inline-flex items-center justify-center w-8 h-8 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors">
            <i data-lucide="x" class="w-4 h-4 text-slate-300"></i>
          </button>
        </div>
      </div>
      
      <!-- Progress Bar -->
      <div class="h-1 bg-slate-800">
        <div id="readerProgress" class="h-full bg-gradient-to-r from-cyan-400 to-blue-400 transition-all duration-300" style="width: 0%"></div>
      </div>
    </div>

    <!-- Content Tools Toolbar -->
    <div id="contentToolbar" class="hidden sticky top-[69px] z-10 px-4 py-2 bg-slate-950/95 backdrop-blur border-b border-white/10">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <button id="highlightTool" class="inline-flex items-center gap-1 text-[12px] px-2 py-1 rounded-md bg-amber-500/15 hover:bg-amber-500/25 text-amber-300 ring-1 ring-amber-500/25 transition-colors">
            <i data-lucide="highlighter" class="w-3.5 h-3.5"></i>
            Highlight
          </button>
          <button id="noteTool" class="inline-flex items-center gap-1 text-[12px] px-2 py-1 rounded-md bg-purple-500/15 hover:bg-purple-500/25 text-purple-300 ring-1 ring-purple-500/25 transition-colors">
            <i data-lucide="sticky-note" class="w-3.5 h-3.5"></i>
            Note
          </button>
          <button id="copyTool" class="inline-flex items-center gap-1 text-[12px] px-2 py-1 rounded-md bg-cyan-500/15 hover:bg-cyan-500/25 text-cyan-300 ring-1 ring-cyan-500/25 transition-colors">
            <i data-lucide="copy" class="w-3.5 h-3.5"></i>
            Copy
          </button>
        </div>
        <div class="flex items-center gap-2">
          <span id="selectionInfo" class="text-[11px] text-slate-400"></span>
          <button id="clearSelection" class="inline-flex items-center justify-center w-6 h-6 rounded text-slate-400 hover:text-slate-300 hover:bg-white/5 transition-colors">
            <i data-lucide="x" class="w-3.5 h-3.5"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Reader Content -->
    <div class="reader-content pt-20 pb-8">
      <div class="max-w-4xl mx-auto px-4">
        <!-- Loading State -->
        <div id="readerLoading" class="flex flex-col items-center justify-center py-20">
          <div class="w-12 h-12 rounded-lg bg-cyan-500/10 ring-1 ring-cyan-500/20 flex items-center justify-center mb-4">
            <i data-lucide="loader-2" class="w-6 h-6 text-cyan-300 animate-spin"></i>
          </div>
          <h3 class="text-[16px] font-medium text-slate-100 mb-2">Loading Article</h3>
          <p class="text-[14px] text-slate-400 text-center">Fetching content from the web...</p>
        </div>

        <!-- Error State -->
        <div id="readerError" class="hidden flex flex-col items-center justify-center py-20">
          <div class="w-12 h-12 rounded-lg bg-red-500/10 ring-1 ring-red-500/20 flex items-center justify-center mb-4">
            <i data-lucide="alert-circle" class="w-6 h-6 text-red-300"></i>
          </div>
          <h3 class="text-[16px] font-medium text-slate-100 mb-2">Unable to Load Article</h3>
          <p class="text-[14px] text-slate-400 text-center mb-4">There was an error loading this article.</p>
          <button id="readerRetry" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-cyan-500/15 hover:bg-cyan-500/25 text-cyan-300 ring-1 ring-cyan-500/25">
            <i data-lucide="refresh-cw" class="w-4 h-4"></i>
            Try Again
          </button>
        </div>

        <!-- AI Summary Loading -->
        <div id="summaryLoading" class="hidden flex flex-col items-center justify-center py-12">
          <div class="w-12 h-12 rounded-lg bg-cyan-500/10 ring-1 ring-cyan-500/20 flex items-center justify-center mb-4">
            <i data-lucide="sparkles" class="w-6 h-6 text-cyan-300 animate-pulse"></i>
          </div>
          <h3 class="text-[16px] font-medium text-slate-100 mb-2">Generating Summary</h3>
          <p class="text-[14px] text-slate-400 text-center mb-6">AI is analyzing the article to create your summary...</p>
          <div class="flex items-center gap-3">
            <button id="summaryLoadingOriginal" class="inline-flex items-center gap-1.5 text-[13px] px-3 py-2 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10 transition-colors">
              <i data-lucide="external-link" class="w-4 h-4"></i>
              Open Original
            </button>
            <span class="text-[12px] text-slate-500">or wait for summary</span>
          </div>
        </div>

        <!-- Summary Content -->
        <div id="readerSummary" class="hidden">
          <!-- TLDR Section -->
          <div class="mb-8">
            <div class="flex items-center gap-2 mb-3">
              <div class="w-8 h-8 rounded-md bg-cyan-500/10 ring-1 ring-cyan-500/20 flex items-center justify-center">
                <i data-lucide="zap" class="w-4 h-4 text-cyan-300"></i>
              </div>
              <h2 class="text-[18px] font-semibold text-slate-100">TL;DR</h2>
            </div>
            <div id="summaryTldr" class="text-[15px] text-slate-300 leading-relaxed bg-white/5 ring-1 ring-white/10 rounded-lg p-4">
              <!-- TLDR content will be inserted here -->
            </div>
          </div>

          <!-- Key Points Section -->
          <div class="mb-8">
            <div class="flex items-center gap-2 mb-3">
              <div class="w-8 h-8 rounded-md bg-emerald-500/10 ring-1 ring-emerald-500/20 flex items-center justify-center">
                <i data-lucide="list" class="w-4 h-4 text-emerald-300"></i>
              </div>
              <h2 class="text-[18px] font-semibold text-slate-100">Key Points</h2>
            </div>
            <ul id="summaryKeyPoints" class="space-y-2">
              <!-- Key points will be inserted here -->
            </ul>
          </div>

          <!-- Core Ideas Section -->
          <div class="mb-8">
            <div class="flex items-center gap-2 mb-3">
              <div class="w-8 h-8 rounded-md bg-purple-500/10 ring-1 ring-purple-500/20 flex items-center justify-center">
                <i data-lucide="brain" class="w-4 h-4 text-purple-300"></i>
              </div>
              <h2 class="text-[18px] font-semibold text-slate-100">Core Ideas</h2>
            </div>
            <div id="summaryCoreIdeas" class="text-[15px] text-slate-300 leading-relaxed space-y-4">
              <!-- Core ideas content will be inserted here -->
            </div>
          </div>

          <!-- Key Quotes Section -->
          <div class="mb-8">
            <div class="flex items-center gap-2 mb-3">
              <div class="w-8 h-8 rounded-md bg-amber-500/10 ring-1 ring-amber-500/20 flex items-center justify-center">
                <i data-lucide="quote" class="w-4 h-4 text-amber-300"></i>
              </div>
              <h2 class="text-[18px] font-semibold text-slate-100">Key Quotes</h2>
            </div>
            <div id="summaryQuotes" class="space-y-3">
              <!-- Key quotes will be inserted here -->
            </div>
          </div>
        </div>

        <!-- Article Content -->
        <div id="readerArticle" class="hidden prose prose-slate prose-invert max-w-none">
          <!-- Article content will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Reader Footer -->
    <div class="reader-footer fixed bottom-0 left-0 right-0 z-10 bg-slate-950/95 backdrop-blur border-t border-white/10">
      <div class="flex items-center justify-between px-4 py-3">
        <div class="flex items-center gap-4">
          <div class="flex items-center gap-2">
            <span class="text-[12px] text-slate-400">Reading time:</span>
            <span id="readerTime" class="text-[12px] text-slate-300">2 min</span>
          </div>
          <div id="summaryStats" class="hidden flex items-center gap-2">
            <span class="text-[12px] text-slate-400">•</span>
            <span class="text-[12px] text-slate-400">Summary:</span>
            <span id="summaryTime" class="text-[12px] text-slate-300">1 min</span>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button id="readerOriginal" class="inline-flex items-center gap-1.5 text-[12px] px-2.5 py-1.5 rounded-md bg-white/5 hover:bg-white/10 text-slate-300 ring-1 ring-white/10">
            <i data-lucide="external-link" class="w-3.5 h-3.5"></i>
            Original
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Gentle Insights Modal -->
  <div id="insightsModal" class="hidden fixed inset-0 z-[100] bg-slate-950/60 backdrop-blur">
    <div class="absolute inset-0 flex items-center justify-center p-4">
      <div id="insightsSheet" class="w-full max-w-2xl bg-slate-950 rounded-2xl ring-1 ring-white/10 shadow-2xl translate-y-6 scale-[0.98] opacity-0 transition-all duration-300 will-change-transform overflow-hidden">
        <!-- Header -->
        <div class="flex items-center justify-between px-6 pt-5 pb-4 border-b border-white/5">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-lg bg-cyan-500/10 ring-1 ring-cyan-500/20 flex items-center justify-center">
              <i data-lucide="brain" class="w-5 h-5 text-cyan-300"></i>
            </div>
            <div>
              <h2 class="text-[18px] tracking-tight font-semibold text-slate-100">Gentle Insights</h2>
              <p class="text-[13px] text-slate-400">Understanding your patterns</p>
            </div>
          </div>
          <button id="insightsClose" class="inline-flex items-center justify-center w-9 h-9 rounded-md bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition-colors">
            <i data-lucide="x" class="w-4 h-4 text-slate-200"></i>
          </button>
        </div>

        <!-- Content -->
        <div class="px-6 pt-4 pb-6 max-h-[70vh] overflow-y-auto">
          <!-- Narrative Insights -->
          <div id="narrativeInsights" class="mb-6">
            <h3 class="text-[15px] font-medium text-slate-200 mb-3 flex items-center gap-2">
              <i data-lucide="heart" class="w-4 h-4 text-pink-300"></i>
              Your Story
            </h3>
            <div id="narrativeList" class="space-y-3">
              <!-- Narrative insights will be populated here -->
            </div>
          </div>

          <!-- Gentle Visualizations -->
          <div id="insightsVisualizations" class="space-y-6">
            <!-- Time Flow -->
            <div class="gentle-viz-container p-4">
              <div class="viz-title">Reading Rhythm</div>
              <div id="timeFlowViz" class="w-full h-24"></div>
              <div class="viz-subtitle">When you naturally engage with content</div>
            </div>

            <!-- Content Preferences -->
            <div class="gentle-viz-container p-4">
              <div class="viz-title">Content Harmony</div>
              <div class="flex items-center gap-6">
                <div id="contentPrefViz" class="w-24 h-24"></div>
                <div class="flex-1">
                  <div id="contentPrefLabels" class="space-y-2">
                    <!-- Content preference labels will be populated here -->
                  </div>
                </div>
              </div>
              <div class="viz-subtitle">The mix that resonates with you</div>
            </div>

            <!-- Completion Flow -->
            <div class="gentle-viz-container p-4">
              <div class="viz-title">Completion Flow</div>
              <div id="completionFlowViz" class="w-full h-16"></div>
              <div class="viz-subtitle">Your recent journey through saved items</div>
            </div>
          </div>

          <!-- Gentle Suggestions -->
          <div id="gentleSuggestions" class="mt-6 pt-6 border-t border-white/5">
            <h3 class="text-[15px] font-medium text-slate-200 mb-3 flex items-center gap-2">
              <i data-lucide="compass" class="w-4 h-4 text-emerald-300"></i>
              Gentle Nudges
            </h3>
            <div id="suggestionsList" class="space-y-3">
              <!-- Gentle suggestions will be populated here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</body>
</html>